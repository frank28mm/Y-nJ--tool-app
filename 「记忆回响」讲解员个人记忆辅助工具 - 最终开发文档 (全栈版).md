「记忆回响」讲解员个人记忆辅助工具 - 最终开发文档 (全栈版)文档版本: 3.3 (UI/UX 详尽版)文档状态: 定稿 (Final)创建日期: 2025年8月27日核心技术: Vue.js, Vite, Supabase, AI API1. 项目概述 (Project Overview)1.1 核心使命 (Core Mission)打造一个智能、同步、个人专属的云端训练平台，利用AI技术，帮助讲解员将一篇上万字的、高精度的科学讲稿，高效地、没那么痛苦地“刻”进大脑的肌肉记忆里。1.2 目标用户上海天文馆新晋讲解员团队成员。1.3 开发路线图 (Phased Roadmap)新的技术栈允许我们采用更强大的开发路线图：第一阶段 (MVP - 云同步基础版):目标: 建立用户系统和云端数据同步，让学习进度可保存、可同步。核心功能: 用户认证、云端内容加载、进度云同步、“填空训练”模式。第二阶段 (智能化增强):目标: 引入核心的智能化训练工具，让产品更懂用户。核心功能: “语音核对”王牌功能、离线AI赋能（在数据库中增加“游客可能会问”的Q&A数据）。第三阶段 (实时AI教练):目标: 集成实时AI API，提供即时辅导，让产品成为私人教练。核心功能:“AI小老师”实时问答: 用户可随时向AI提问。“用你自己的话复述”评估模式: AI实时评估用户对内容的理解深度。体验优化: 新手引导、快捷键、性能优化等。2. 软件需求与UI/UX设计2.1 功能性需求 (SRS)(F-05) 用户认证 (管理员分配模式):系统不提供用户自注册界面。所有用户账户由管理员在Supabase后台统一创建和分配。系统必须提供登录界面，供用户使用分配到的凭证（邮箱/密码）登录。用户登录后，所有学习数据必须与其账户ID (user_id) 绑定。系统必须能在不同设备间同步同一用户的学习进度。(F-06) 实时AI问答 (“AI小老师”):在内容展示区，必须提供一个触发“AI小老师”的交互入口。用户点击后，可输入与当前段落相关的任何问题。系统必须通过后端（Supabase Function）安全地调用AI API，并将返回的答案清晰地展示给用户。(F-07) 实时AI复述评估:系统必须提供“用你自己的话复述”训练模式的入口。用户在该模式下，通过语音输入对当前段落的复述。系统必须将语音转写的文本，通过后端发送给AI进行语义分析。系统必须接收AI返回的结构化评估报告（包含是否正确、优点、遗漏点、评分），并以清晰的UI展示给用户。每次评估的结果应被记录在数据库中，用于追踪用户的进步。2.2 线框图 (Wireframe)线框图关注的是结构、布局和功能，暂时忽略美学细节。状态一：默认阅读模式 (Default Reading State)+--------------------------------+----------------------------------------------------+
| [APP TITLE: 记忆回响]          | [H1: 段落标题 - 地球] (2)                            |
|                                |                                                    |
| [Nav Panel] (1)                | [P: 正文内容] (3)                                  |
|                                |   我们的家园地球，是太阳系中一颗充满生机的蓝色星球。   |
|  ▼ 家园展区                    |   它的直径约为12742公里...                         |
|    - 开篇引导                  |                                                    |
|    - [地球] (Active)           |                                                    |
|    - ...                       |                                                    |
|  ▼ 宇宙展区                    |                                                    |
|    - ...                       |                                                    |
|  ▼ ...                         |                                                    |
|                                |                                                    |
|                                |                                                    |
|                                | [操作栏]                                           |
|                                |   +---------------------------------+              |
|                                |   |         [开始填空训练] (4)      |              |
|                                |   +---------------------------------+              |
+--------------------------------+----------------------------------------------------+

注解 (1) NavPanel: 占据屏幕左侧约25%-30%的宽度，内容可垂直滚动。[地球] (Active) 表示当前被选中的段落，有高亮状态。注解 (2) H1:段落标题: 在主工作区的顶部，清晰地显示当前选中段落的标题。注解 (3) P:正文内容: 展示该段落的完整讲解词。注解 (4) 开始填空训练: 当前视图下的主要操作按钮。状态二：填空训练模式 (Fill-in-the-Blank State)+--------------------------------+----------------------------------------------------+
| [APP TITLE: 记忆回响]          | [H1: 段落标题 - 地球]                                |
|                                |                                                    |
| [Nav Panel]                    | [填空训练区] (5)                                   |
|                                |   它的直径约为 [____12742____] (Input: Correct) 公里...|
|  ▼ 家园展区                    |                                                    |
|    - 开篇引导                  |   ...是太阳系中一颗充满 [____生机____] (Input: Wrong) 的 |
|    - [地球] (Active)           |   蓝色星球。 [Correct Answer: 生命]                  |
|    - ...                       |                                                    |
|  ▼ 宇宙展区                    |                                                    |
|                                |                                                    |
|                                | [操作栏]                                           |
|                                |   +---------------------------------+              |
|                                |   |          [返回阅读] (6)         |              |
|                                |   +---------------------------------+              |
+--------------------------------+----------------------------------------------------+

注解 (5) 填空训练区: 原有的正文内容被替换为带有输入框的文本。(Input: Correct) 和 (Input: Wrong) 分别表示用户填写正确与错误后的视觉状态。注解 (6) 返回阅读: 操作栏的按钮文本和功能发生改变，允许用户退出训练模式。2.3 视觉风格指南 V2.0：落日星辰 (Sunset & Stars)本设计方案严格遵循您提供的配色图，以构建一个和谐且具有明确视觉引导的界面。色彩系统 (Color Palette)角色 (Role)色值 (HEX)色板名称用途说明背景 - 主色#003049质感主蓝应用的整体背景色，提供深邃、专注的基调。文字 - 主色#EAE2B7香草所有主要的标题、正文文本颜色，在深蓝背景上提供柔和、清晰的阅读体验。文字 - 次色rgba(234, 226, 183, 0.65)香草 (65%透明度)辅助性、非关键性文本，如提示、placeholder等。交互/强调色#F77F00橙色 (桔子)最关键的行动色。 用于按钮、链接、输入框焦点、选中状态和成功状态。状态 - 警告#FCBF49黄原胶用于需要注意但非错误的中间状态，如“熟练”等级。状态 - 失败#D62828消防车红色用于明确的错误提示、失败状态，如“生疏”等级。字体系统 (Typography)主字体 (Font-Family): 思源黑体 (Noto Sans SC), sans-serif基础字号 (Base Size): 16px颜色：标题/正文：#EAE2B7 (文字 - 主色)辅助文字：rgba(234, 226, 183, 0.65) (文字 - 次色)核心组件样式 (Components)按钮 (Button):默认状态: background: transparent; border: 1px solid #F77F00; color: #F77F00; padding: 12px 24px; border-radius: 4px; cursor: pointer; transition: all 0.2s ease-in-out;悬浮状态 (Hover): background: rgba(247, 127, 0, 0.1);输入框 (Input - for Fill-in-the-Blank):默认状态: background: transparent; border: 1px solid rgba(234, 226, 183, 0.65); border-radius: 4px; color: #EAE2B7; padding: 8px 12px;焦点状态 (Focus): border-color: #F77F00;成功状态 (Success): border-color: #F77F00; (与焦点同色，保持简洁)失败状态 (Error): border-color: #D62828;导航面板 (Navigation Panel):条目默认样式: color: rgba(234, 226, 183, 0.65); padding: 8px 16px; border-left: 3px solid transparent;条目悬浮样式: background: rgba(234, 226, 183, 0.05);条目选中样式: color: #F77F00; background: rgba(247, 127, 0, 0.1); border-left: 3px solid #F77F00;3. 技术规格与实现指南3.1 技术选型核心框架: Vue.js (版本 3) + Vite后端即服务 (BaaS): Supabase状态管理: Pinia3.2 数据库 Schema (Supabase PostgreSQL)paragraphs (讲解稿段落表)... (字段不变) ...(新增) potential_qa: JSONB (存储由AI预生成的Q&A数据)user_progress (用户进度表)... (字段不变) ...(新增) user_paraphrase_evaluations (用户复述评估记录表)id: UUID (Primary Key)user_id: UUID (Foreign Key to auth.users.id)paragraph_id: UUID (Foreign Key to paragraphs.id)paraphrased_text: TEXT (用户复述的文本)evaluation_result: JSONB (存储AI返回的完整结构化评估报告)score: INTEGER (从评估报告中提取的分数)created_at: TIMESTAMP WITH TIME ZONE3.3 代码架构与文件结构文件结构调整:memory-echo/
...
├── src/
│   ├── components/
│   │   ├── auth/              // 新增：存放登录组件
│   │   │   └── AuthForm.vue
│   │   ├── layout/            // 新增：存放布局组件
│   │   │   └── AppHeader.vue
│   │   ├── ai/
│   │   │   ├── AiTutor.vue
│   │   │   └── ParaphraseTrainer.vue // 新增：复述训练及报告组件
...
└── supabase/
    └── functions/
        ├── ai-tutor/             // AI小老师云函数
        └── paraphrase-evaluator/ // 新增：复述评估云函数
            └── index.ts

3.4 (新增) 后端功能与交互后端能力完全由Supabase提供。管理员通过Supabase官方后台进行管理，应用前端通过Supabase客户端库与后端交互。3.4.1 管理员后台功能 (Supabase Dashboard)用户创建与管理: 管理员直接在Supabase后台的 "Authentication" -> "Users" 面板中创建新用户。创建时需提供用户的邮箱并设置初始密码。管理员也可在此处为用户重置密码或禁用账户。数据管理: 管理员可通过 "Table Editor" 直接查看和管理 paragraphs, user_progress 等表中的数据。3.4.2 核心安全策略 (Row Level Security - RLS)这是保障数据安全的核心。必须为需要保护的表启用RLS，并设置以下策略：user_progress 表策略:SELECT: 用户只能查询 user_id 与自身认证ID (auth.uid()) 匹配的行。INSERT/UPDATE: 用户只能向 user_id 与自身认证ID (auth.uid()) 匹配的行写入或更新数据。user_paraphrase_evaluations 表策略:与 user_progress 表的策略相同，确保用户只能访问和创建自己的评估记录。3.4.3 前后端交互流程登录: 前端调用 supabase.auth.signInWithPassword()，将用户输入的邮箱密码发送给Supabase进行验证。会话保持: 登录成功后，Supabase客户端库自动处理JWT令牌的存储和刷新，确保后续请求的认证状态。数据操作: 前端所有对数据库的CRUD（增删改查）操作，都会自动携带认证信息。后端的RLS策略会基于此信息进行权限校验，实现数据隔离。3.5 实时AI功能实现流程3.5.1 “AI小老师” (问答模式)前端 (AiTutor.vue): 用户输入问题。调用云函数: 调用 ai-tutor 云函数，发送 { query, context }。后端 (ai-tutor/index.ts): 构造一个问答型的Prompt，调用AI API。前端: 展示AI返回的直接回答。3.5.2 “用你自己的话复述” (评估模式)前端 (ParaphraseTrainer.vue): 用户通过语音输入复述，前端完成语音转文字。调用云函数: 调用 paraphrase-evaluator 云函数，发送 { originalText, paraphrasedText }。后端 (paraphrase-evaluator/index.ts):构造一个评估型的Prompt，要求AI扮演教练角色，并严格按照预设的JSON格式返回评估结果。(关键) Prompt中需包含清晰的JSON Schema定义，以确保返回结果的稳定性和一致性。调用AI API。将AI返回的JSON字符串解析后，存入 user_paraphrase_evaluations 表。将评估结果返回给前端。前端: 接收结构化的评估数据，并渲染成图文并茂的报告。这个流程确保了不同AI功能的逻辑分离，并且将评估数据持久化，为未来进行用户学习曲线分析打下了基础。